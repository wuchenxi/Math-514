\documentclass[20pt]{article} % USenglish for autoref
\usepackage[paper=screen, centering, papersize=20cm]{geometry}
\usepackage{cmap}		% to search and copy ligatures
\usepackage[utf8]{inputenc}	% for Linux computer and Mac
%\usepackage[latin1]{inputenc}	% f√ºr Windows computer
\usepackage[T1]{fontenc}	% to search for ligatures in the pdf
\usepackage[USenglish]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{amsthm}
\usepackage{graphicx}
%\usepackage{stmaryrd}		% for \mapsfrom
\usepackage{aliascnt}		% for Aliascounter so that autoref gives the thms the right names
\usepackage[pdfborder={0 0 0}]{hyperref}   % if you want to have math environment in captions you have to use \texorpdfstring{$x^2$}{x2}; without frame around the links
\usepackage[figure]{hypcap}		% to make autoref link to figures and not the captions of figures
%\usepackage{paralist}		% for compactitem
\usepackage{mathtools}		% for \coloneqq
\usepackage[]{todonotes}	% use option disable to disable all the todos
\usepackage{float}
\usepackage{lipsum}
\theoremstyle{break}
\newtheorem{definition}{Definition}[section]  
\newtheorem{exa}[definition]{Example}
\newtheorem{cor}[definition]{Corollary}
\newtheorem{lem}[definition]{Lemma}
\newtheorem{conj}[definition]{Conjecture}
\newtheorem{quest}[definition]{Research question}
\newtheorem{thm}[definition]{Theorem}  
\newtheorem{prop}[definition]{Proposition}
\newtheorem{rem}[definition]{Remark}


\renewcommand{\labelenumi}{(\roman{enumi})} % roman numbers in enumerations

\usepackage{graphicx,tikz} % Allows including images

\usetikzlibrary{calc,decorations.markings}
\usetikzlibrary{shapes,snakes}

\DeclareMathOperator{\Aff}{Aff}
\DeclareMathOperator{\der}{der}
\DeclareMathOperator{\Trans}{Trans}
\DeclareMathOperator{\dir}{dir}
\DeclareMathOperator{\Sing}{Sing}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\NN}{\mathbb{N}}


%For L Cal and L Twidle:
\newcommand{\LC}{\mathcal{L}} 
\newcommand{\LT}{\widetilde{\mathcal{L}}}

%For X bar
\newcommand{\XB}{\overline{X}}

%For the real and complex numbers
\newcommand{\RR}{\mathbb{R}} 
\newcommand{\CC}{\mathbb{C}} 


\newcommand{\remark}[2][]{\todo[color=green!50, #1]{#2}}

\title{HW 4}


\begin{document}
\maketitle

1. Let $f(x)=x^3$, $p$ be the Lagrange interpolation polynomial of $f$ using interpolation points $x=0$, $x=1$.  On the interval $[0, 1]$, find the point $c$ that maximizes the interpolation error $|f(c)-p(c)|$, and find another point $s\in [0, 1]$ such that
\[f(c)-p(c)=f''(s)c(c-1)/2\]

Answer:\\

\[p(x)=0\cdot{x-1\over 0-1}+1\cdot{x-0\over 1-0}=x\]
\[|f-p|=|x^3-x|\]
So this is maximalized at point $c={\sqrt{3}\over 3}$.
\[f(c)-p(c)=c^3-c=3sc(c-1)\]
So
\[s={c+1\over 3}={\sqrt{3}+3\over 9}\]

\newpage

2. Let $f(x)=e^x$, $p$ be the Lagrange interpolation polynomial of $f$ on interval $[0, 2]$ using interpolation points $x_0=0$, $x_1=1$, $x_2=2$, find an upper bound for the $L^\infty$ norm of $f(x)-p(x)$ on $[0, 2]$, using the error bound of Lagrange polynomial we covered in the lecture (Theorem 6.2 in textbook, Theorem 1.5 in lecture notes).\\

Answer:\\

The error bound of Lagrange polynomial is
\[|f(x)-p(x)|={|f'''(c)||x(x-1)(x-2)|\over 3!}\]
When $c\in [0, 2]$, $|f'''(c)|\leq e^2$.\\
When $x\in [0, 2]$, $|x(x-1)(x-2)|\leq {2\sqrt{3}\over 9}$.\\
Hence an upper bound for this error is $e^2\sqrt{3}\over 27$.\\
It's ok if you get a slightly larger error bound, for example $4e^2/3$.\\

\newpage

3. Suppose $f$ is continuous and with continuous derivatives of order up to and including 5 on $[a, b]$, and there are three distinct points $x_0$, $x_1$, $x_2$ in $[a, b]$. Let $y_i=f(x_i)$, $i=0, 1, 2$; $z_j=f'(x_j)$, $j=0, 2$.
\begin{enumerate}
\item Find a polynomial $p$ of degree at most $4$, such that $p(x_i)=y_i$, $i=0, 1, 2$; $p'(x_j)=z_j$, $j=0, 2$.
\item Use an argument similar to the error estimate of Hermite interpolation polynomial to show that for any $x\in [a, b]$, there is some number $s\in [a, b]$ such that
  \[f(x)-p(x)=f^{(5)}(s)(x-x_0)^2(x-x_1)(x-x_2)^2/5!\]
\end{enumerate}

Answer:\\

\begin{enumerate}
\item \begin{itemize}
  \item Approach I: We can find five polynomials $p_0$, $p_1$, $p_2$, $q_0$, $q_2$, such that
    \[p_0(x_0)=p_1(x_1)=p_2(x_2)=q'_0(x_0)=q'_2(x_2)=1\]
    \[p_i(x_j)=0\text{ when }i\not=j\]
    \[p_i'(x_j)=0\text{ when }j=0, 2\]
    \[q'_0(x_2)=q'_2(x_0)=0\]
    \[q_i(x_j)=0\]
    Then the answer can be written as
    \[p=\sum_iy_ip_i+z_0q_0+z_2q_2\]
    To get $p_0$, from $p_0(x_1)=p_0(x_2)=p'_0(x_2)=0$ we get $p_0=(x-x_1)(x-x_2)^2(Ax+B)$, now use the remaining two conditions, $p_0(x_0)=1$, $p_0'(x_0)=0$, to solve for $A$ and $B$, we get
    \[p_0={(x-x_1)(x-x_2)^2\over (x_0-x_1)(x_0-x_2)^2}(1-(x-x_0)({1\over x_0-x_1}+{2\over x_0-x_2}))\]
    Similarly,
    \[p_1={(x-x_0)^2(x-x_2)^2\over (x_1-x_0)^2(x_1-x_2)^2}\]
    \[p_2={(x-x_0)^2(x-x_1)\over (x_2-x_0)^2(x_2-x_1)}(1-(x-x_2)({2\over x_2-x_0}+{1\over x_2-x_1}))\]
    \[q_0={(x-x_0)(x-x_1)(x-x_2)^2\over (x_0-x_1)(x_0-x_2)^2}\]
    \[q_2={(x-x_0)^2(x-x_1)(x-x_2)\over (x_2-x_0)^2(x_2-x_1)}\]
    So
    \[p=y_0{(x-x_1)(x-x_2)^2\over (x_0-x_1)(x_0-x_2)^2}(1-(x-x_0)({1\over x_0-x_1}+{2\over x_0-x_2}))\]
    \[+y_1{(x-x_0)^2(x-x_2)^2\over (x_1-x_0)^2(x_1-x_2)^2}\]
    \[+y_2{(x-x_0)^2(x-x_1)\over (x_2-x_0)^2(x_2-x_1)}(1-(x-x_2)({2\over x_2-x_0}+{1\over x_2-x_1}))\]
    \[+z_0{(x-x_0)(x-x_1)(x-x_2)^2\over (x_0-x_1)(x_0-x_2)^2}\]
    \[+z_2{(x-x_0)^2(x-x_1)(x-x_2)\over (x_2-x_0)^2(x_2-x_1)}\]
  \item We can also use Hermite interpolation polynomial: suppose $p'(x_1)=a$, use all information for $p(x_i)$, $i=0, 1, 2$ and $p'(x_i)$, $i=0, 1, 2$, we can write down the Hermite interpolation polynomial which is a polynomial of degree at most $5$. The coefficient for $x^5$ is
    \[-{y_0\over (x_0-x_1)^2(x_0-x_2)^2}({2\over x_0-x_1}+{2\over x_0-x_2})\]
    \[-{y_1\over (x_1-x_0)^2(x_1-x_2)^2}({2\over x_1-x_0}+{2\over x_1-x_2})\]
    \[-{y_2\over (x_2-x_1)^2(x_2-x_0)^2}({2\over x_2-x_1}+{2\over x_2-x_0})\]
    \[+{z_0\over (x_0-x_1)^2(x_0-x_2)^2}+{a\over (x_1-x_0)^2(x_1-x_2)^2}\]
    \[+{z_2\over (x_2-x_0)^2(x_2-x_1)^2}\]
    Since we want $p$ to be of degree no more than $4$, we must set this coefficient to be $0$. Hence
    \[a={y_0(x_1-x_2)^2\over (x_0-x_2)^2}({2\over x_0-x_1}+{2\over x_0-x_2})\]
      \[+y_1({2\over x_1-x_0}+{2\over x_1-x_2})\]
      \[+{y_2(x_1-x_0)^2\over (x_2-x_0)^2}({2\over x_2-x_1}+{2\over x_2-x_0})\]
      \[-{z_0(x_1-x_2)^2\over (x_0-x_2)^2}-{z_2(x_1-x_0)^2\over (x_2-x_0)^2}\]
      Now put this in the formula for Hermite interpolation polynomials, you'll get the exact same answer as above.
 \end{itemize}

    \item If $x=x_i$ it's trivially true. Now suppose $x\not=x_i$ for any $i$, consider
      \[G(t)=f(t)-p(t)-{(f(x)-p(x))(t-x_0)^2(t-x_1)(t-x_2)^2\over (x-x_0)^2(x-x_1)(x-x_2)^2}\]
      $G(x)=G(x_i)=G'(x_0)=G'(x_2)=0$, so $G'$ is zero at at least 5 points, $G^{(5)}$ is zero at at least one point. Let that point be $s$, then $G^{(5)}(s)=0$ implies the equation we need to prove.
\end{enumerate}

\newpage

4. Let $q_j=(1-x^2)^j$, $\varphi_j=q_j^{(j)}$, show that $\varphi_j$ are orthogonal to each other in $L^2([-1, 1])$. In other words, if $j\not=j'$, $\int_{-1}^1\varphi_j\varphi_{j'}dx=0$. \\

Answer:\\

Firstly we show that if $i<j$, then $q_j^{(i)}$ has a factor $(1-x^2)^{j-i}$. Do induction on $i$. It is trivially true for $i=0$. Now, suppose $q_j^{(i)}=(1-x^2)^{j-i}h(x)$ where $h$ is a polynomial, then, by product rule,
\[q_j^{(i+1)}=((1-x^2)^{j-i}h(x))'=-2(j-i)x(1-x^2)^{j-i-1}h(x)+(1-x^2)^{j-i}h'(x)\]
\[=(1-x^2)^{j-i-1}(-2(j-i)xh(x)+(1-x^2)h'(x))\]
Hence by induction this statement is proved.\\

Now, because $\varphi_i$ are all non-zero, they all have non-zero $L^2$ norms on $[-1, 1]$. We only need to show that when $i\not=j$, $\int_{-1}^1\varphi_i\varphi_jdx=0$. Without loss of generality assume $i<j$, then by integration by parts and the conclusion in the previous step,
\[\int_{-1}^1\varphi_i\varphi_jdx=\int_{-1}^1 q_i^{(i)}q_j^{(j)}dx\]
\[=-\int_{-1}^1q_i^{(i+1)}q_j^{(j-1)}dx\]
\[=\int_{-1}^1q_i^{(i+2)}q_j^{(j-2)}dx\]
\[=\dots=(-1)^j\int_{-1}^1q_i^{(i+j)}q_jdx\]
However the degree of $q_i$ is $2i<i+j$, hence $q_i^{(i+j)}=0$, which implies that the integration is zero.\\

\newpage

5. Find three distinct points $x_0$, $x_1$ and $x_2$ in $(-1, 1)$, such that for any polynomial function $f$ of degree $3$, the best approximation of $f$ under $L^2$ norm on $[-1, 1]$ of degree at most $2$ coincides with the Lagrange interpolation polynomial of $f$ using interpolation points $x_0$, $x_1$ and $x_2$.\\

Answer:\\

Suppose $f$ is the degree 3 Legendre polynomial $f_3=x^3-{3\over 5}x$, then, because it is orthogonal to the degree 0, 1, and 2 Legendre polynomials under $L^2([-1, 1])$, and these three Legendre polynomials form an orthogonal basis of the space $V_2$ of polynomials of degree no more than 2, the best approximation formula in inner product space implies that the best approximation of $f$ on $V_2$ under $L^2([-1, 1])$ norm must be $0$. By assumption, the Legendre interpolation of $f_3$ at $x_0$, $x_1$ and $x_2$ must also be zero, so these three points can only be the three roots of $x^3-{3\over 5}x$, which are $0, \pm\sqrt{3\over 5}$.\\

Now suppose $f=\sum_{i=0}^3a_ix^i$ is any degree $3$ polynomial. Then, because $f-a_3f_3$ is of degree at most $2$ and is identical to $f$ at $0, \pm\sqrt{3\over 5}$, the Lagrange interpolation of $f$ at $x_i$ is $f-a_3f_3$. On the other hand, let $e_0, e_1, e_2$ be any orthogonal basis of $V_2$, then the best approximation of $f$ on $V_2$ under $L^2([-1, 1])$ norm is $\sum_i(f, e_i)e_i$. However, because $f_3$ is orthogonal to $V_2$, $(f, e_i)=(f-a_3f_3, e_i)$, so the best approximation of $f$ is the same as the best approximation of $f-a_3f_3$, which must be $f-a_3f_3$ itself as $f-a_3f_3\in V_2$. This proves that $x_i$ being $0, \pm\sqrt{3\over 5}$ satisfies the requirement in the problem.\\

\newpage

6. Let $f$ be a continuous function on $[0, 1]$, $p_n$ be the polynomial of best approximation of degree no more than $n$ under the $L^2$ norm. Then, after studying Theorem 9.5 in the textbook, which proved that $f-p_n$ is zero at at least $n+1$ distinct points in $(0, 1)$, find a function $f$ such that $f-p_2$ is zero at $4$ distinct points in $(0, 1)$.\\

Answer:\\

Let $V_2$ be the space of polynomials of degree no more than $2$. If we pick $f$ to be anything orthogonal to $V_2$ under the $L^2([0, 1])$ norm, then the best approximation of $f$ on $V_2$ must be zero, so we just need to pick such a $f$ with $4$ or more zeros. So, for example, we can pick the degree $4$ orthogonal polynomials with weight $1$ on $[0, 1]$, which is $70x^4-140x^3+90x^2-20x+1$.

\end{document}